
%macro freq(LIBRARY);
	PROC SQL NOPRINT;
		SELECT MEMNAME INTO: TABLES SEPARATED BY " " 
		FROM DICTIONARY.TABLES 
		WHERE LIBNAME = "&LIBRARY" AND MEMTYPE = "DATA";
	QUIT;
	
	PROC FORMAT;
		VALUE $MISSFMT ' ' = 'MISSING' OTHER = 'NOT MISSING';
		VALUE MISSFMT . = 'MISSING' OTHER = "NOT MISSING";
	RUN;
	
	%DO I = 1 %TO %sysfunc(countw(&TABLES));
	 %LET TABLE = %SCAN(&TABLES, &I);
	 
	 	PROC FREQ DATA= &LIBRARY..&TABLE;
	 		FORMAT _CHAR_ $MISSFMT. ;
	 		TABLES _CHAR_ / MISSING MISSPRINT NOCUM NOPERCENT;
	 		FORMAT _NUMERIC_ MISSFMT. ;
	 		TABLES _NUMERIC_ / MISSING MISSPRINT NOCUM NOPERCENT;
	 		OUTPUT OUT= RESULT&I;
	 	RUN;
	 	
	 %END;
%MEND FREQ;

%FREQ(NAMAN);
